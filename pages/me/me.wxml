<navigation-bar title="我的" back="{{false}}" color="black" background="#f8fbff"></navigation-bar>

<scroll-view class="scrollarea" scroll-y enhanced enable-flex show-scrollbar="false">
  <view class="page">
    <view class="card profile">
      <view wx:if="{{currentUser}}" class="profile-row">
        <view class="avatar">{{avatarText}}</view>
        <view class="profile-content">
          <view class="name-row">
            <view class="name">{{currentUser.nickname}}</view>
            <view wx:if="{{isAdmin}}" class="role-tag">管理员</view>
          </view>
          <view class="meta">手机号：{{currentUser.phone}}</view>
        </view>
      </view>
      <view wx:else>
        <view class="name">未登录</view>
        <view class="meta">登录后可管理聊天和帖子</view>
      </view>
    </view>

    <view class="stats">
      <view class="card stat">
        <view class="value">{{stats.itemCount}}</view>
        <view class="label">平台在架</view>
      </view>
      <view class="card stat">
        <view class="value">{{stats.sessionCount}}</view>
        <view class="label">我的会话</view>
      </view>
      <view class="card stat">
        <view class="value">{{stats.myPostCount}}</view>
        <view class="label">我的帖子</view>
      </view>
    </view>

    <view class="card actions">
      <button wx:if="{{!currentUser}}" class="auth-btn" bindtap="goAuth">登录 / 注册</button>
      <block wx:if="{{currentUser}}">
        <button class="msg-btn" bindtap="goMessages">查看信息</button>
        <button class="manage-btn" bindtap="goPostManage">{{isAdmin ? '管理全部帖子' : '管理我的帖子'}}</button>
        <button class="logout-btn" bindtap="logout">退出登录</button>
      </block>
    </view>
  </view>
</scroll-view>
